<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate PERMANOVA (Permutational Multivariate Analysis of Variance) — getPERMANOVA • mia</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate PERMANOVA (Permutational Multivariate Analysis of Variance) — getPERMANOVA"><meta property="og:description" content="These functions perform PERMANOVA to assess the significance of group
differences based on a specified dissimilarity matrix. The results can be
returned directly or added to metadata in an object of class
TreeSummarizedExperiment."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.23</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/mia.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/microbiome/mia/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate PERMANOVA (Permutational Multivariate Analysis of Variance)</h1>
    <small class="dont-index">Source: <a href="https://github.com/microbiome/mia/blob/master/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/microbiome/mia/blob/master/R/getPERMANOVA.R" class="external-link"><code>R/getPERMANOVA.R</code></a></small>
    <div class="hidden name"><code>getPERMANOVA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions perform PERMANOVA to assess the significance of group
differences based on a specified dissimilarity matrix. The results can be
returned directly or added to metadata in an object of class
<code>TreeSummarizedExperiment</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getPERMANOVA</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">addPERMANOVA</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'SingleCellExperiment'</span></span>
<span><span class="fu">getPERMANOVA</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'SummarizedExperiment'</span></span>
<span><span class="fu">getPERMANOVA</span><span class="op">(</span><span class="va">x</span>, assay.type <span class="op">=</span> <span class="st">"counts"</span>, formula <span class="op">=</span> <span class="cn">NULL</span>, col.var <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'ANY'</span></span>
<span><span class="fu">getPERMANOVA</span><span class="op">(</span><span class="va">x</span>, <span class="va">formula</span>, <span class="va">data</span>, method <span class="op">=</span> <span class="st">"bray"</span>, test.homogeneity <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'SummarizedExperiment'</span></span>
<span><span class="fu">addPERMANOVA</span><span class="op">(</span><span class="va">x</span>, name <span class="op">=</span> <span class="st">"permanova"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code><a href="https://rdrr.io/pkg/TreeSummarizedExperiment/man/TreeSummarizedExperiment-class.html" class="external-link">TreeSummarizedExperiment</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to <code><a href="https://rdrr.io/pkg/vegan/man/adonis.html" class="external-link">vegan::adonis2</a></code>.</p><ul><li><p><code>by</code>: <code>Character scalar</code>. Specifies how significance is
calculated. (Default: <code>"margin"</code>)</p></li>
<li><p><code>na.action</code>: <code>function</code>. Action to take when missing
values for any of the variables in <code>formula</code> are encountered.
(Default: <code>na.fail</code>)</p></li>
<li><p><code>full</code> <code>Logical scalar</code>. should all the results from the
homogeneity calculations be returned. When <code>FALSE</code>, only
summary tables are returned. (Default: <code>FALSE</code>)</p></li>
<li><p><code>homogeneity.test</code>: <code>Character scalar</code>. Specifies
the significance test used to analyse
<code><a href="https://rdrr.io/pkg/vegan/man/betadisper.html" class="external-link">vegan::betadisper</a></code> results.
Options include 'permanova'
(<code><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html" class="external-link">vegan::permutest</a></code>), 'anova'
(<code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">stats::anova</a></code>) and 'tukeyhsd'
(<code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">stats::TukeyHSD</a></code>).
(Default: <code>"permanova"</code>)</p></li>
</ul></dd>


<dt id="arg-assay-type">assay.type<a class="anchor" aria-label="anchor" href="#arg-assay-type"></a></dt>
<dd><p><code>Character scalar</code>. Specifies the name of assay
used in calculation. (Default: <code>"counts"</code>)</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p><code>formula</code>. If <code>x</code> is a
<code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></code>
a formula can be supplied. Based on the right-hand side of the given formula
<code>colData</code> is subset to <code>col.var</code>.</p>
<p><code>col.var</code> and <code>formula</code> can be missing, which turns the CCA
analysis into a CA analysis and dbRDA into PCoA/MDS.</p></dd>


<dt id="arg-col-var">col.var<a class="anchor" aria-label="anchor" href="#arg-col-var"></a></dt>
<dd><p><code>Character scalar</code>. When <code>x</code> is a
<code>SummarizedExperiment</code>,<code>col.var</code> can be used to specify variables
from <code>colData</code>.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><code>data.frame</code> or coarcible to one. The covariance table
including covariates defined by <code>formula</code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p><code>Character scalar</code>. A dissimilarity metric used in
PERMANOVA and group dispersion calculation. (Default: <code>"bray"</code>)</p></dd>


<dt id="arg-test-homogeneity">test.homogeneity<a class="anchor" aria-label="anchor" href="#arg-test-homogeneity"></a></dt>
<dd><p><code>Logical scalar</code>. Should the homogeneity of
group dispersions be evaluated? (Default: <code>TRUE</code>)</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p><code>Character scalar</code>. A name for the results that will be
stored to metadata. (Default: <code>"permanova"</code>)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>getPERMANOVA</code> returns the PERMANOVA results or a list containing the
PERMANOVA results and homogeneity test results if
<code>test.homogeneity = TRUE</code>. <code>addPERMANOVA</code> adds these results to
metadata of <code>x</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>PERMANOVA is a non-parametric method used to test whether the centroids of
different groups (as defined by the formula or covariates) are significantly
different in terms of multivariate space.</p>
<p>PERMANOVA relies on the assumption of group homogeneity, meaning the groups
should be distinct and have similar variances within each group. This
assumption is essential as PERMANOVA is sensitive to differences in
within-group dispersion, which can otherwise confound results.
This is why the functions return homogeneity test results by default.</p>
<p>The functions utilize <code><a href="https://rdrr.io/pkg/vegan/man/adonis.html" class="external-link">vegan::adonis2</a></code> to compute
PERMANOVA. For homogeneity testing,
<code><a href="https://rdrr.io/pkg/vegan/man/betadisper.html" class="external-link">vegan::betadisper</a></code> along
with <code><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html" class="external-link">vegan::permutest</a></code> are utilized by default,
which allow testing for equal dispersion across groups and validate the
homogeneity assumption.</p>
<p>PERMANOVA and distance-based redundancy analysis (dbRDA) are closely related
methods for analyzing multivariate data. PERMANOVA is non-parametric, making
fewer assumptions about the data. In contrast, dbRDA assumes a linear
relationship when constructing the ordination space, although it also
employs a PERMANOVA-like approach to test the significance of predictors
within this space. dbRDA offers a broader scope overall, as it provides
visualization of the constrained ordination, which can reveal patterns and
relationships. However, when the underlying data structure is non-linear,
the results from the two methods can differ significantly due to dbRDA's
reliance on linear assumptions.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>For more details on the actual implementation see
<code><a href="https://rdrr.io/pkg/vegan/man/adonis.html" class="external-link">vegan::adonis2</a></code>,
<code><a href="https://rdrr.io/pkg/vegan/man/betadisper.html" class="external-link">vegan::betadisper</a></code>, and
<code><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html" class="external-link">vegan::permutest</a></code>. See also
<code><a href="runCCA.html">addCCA</a></code> and <code><a href="runCCA.html">addRDA</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">GlobalPatterns</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="va">GlobalPatterns</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Apply relative transformation</span></span></span>
<span class="r-in"><span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu"><a href="transformAssay.html">transformAssay</a></span><span class="op">(</span><span class="va">tse</span>, method <span class="op">=</span> <span class="st">"relabundance"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Perform PERMANOVA</span></span></span>
<span class="r-in"><span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu">addPERMANOVA</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">tse</span>,</span></span>
<span class="r-in"><span>    assay.type <span class="op">=</span> <span class="st">"relabundance"</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"bray"</span>,</span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">x</span> <span class="op">~</span> <span class="va">SampleType</span>,</span></span>
<span class="r-in"><span>    permutations <span class="op">=</span> <span class="fl">99</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># The results are stored to metadata</span></span></span>
<span class="r-in"><span><span class="fu">metadata</span><span class="op">(</span><span class="va">tse</span><span class="op">)</span><span class="op">[[</span><span class="st">"permanova"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $permanova</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for adonis under reduced model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal effects of terms</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adonis2(formula = formula, data = data, permutations = 99, method = ..1, by = by, na.action = na.action)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Df SumOfSqs      R2      F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SampleType  8   8.2466 0.73109 5.7773   0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual   17   3.0332 0.26891                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total      25  11.2798 1.00000                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $homogeneity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Df    Sum Sq    Mean Sq        F N.Perm Pr(&gt;F) Total variance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SampleType  8 0.4996524 0.06245655 5.807135     99   0.01      0.6824898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Explained variance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SampleType          0.7321024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate dbRDA</span></span></span>
<span class="r-in"><span><span class="va">rda_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="runCCA.html">getRDA</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">tse</span>, assay.type <span class="op">=</span> <span class="st">"relabundance"</span>, method <span class="op">=</span> <span class="st">"bray"</span>,</span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">x</span> <span class="op">~</span> <span class="va">SampleType</span>, permutations <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Significance results are similar to PERMANOVA</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">rda_res</span>, <span class="st">"significance"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $permanova</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Df SumOfSqs        F Pr(&gt;F) Total variance Explained variance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model       8  8.24659 5.777341  0.001       11.27982          0.7310924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SampleType  8  8.24659 5.777341  0.010       11.27982          0.7310924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual   17  3.03323       NA     NA       11.27982          0.2689076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $homogeneity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Df    Sum Sq    Mean Sq        F N.Perm Pr(&gt;F) Total variance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SampleType  8 0.4996524 0.06245655 5.807135     99   0.01      0.6824898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Explained variance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SampleType          0.7321024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tuomas Borman, Felix G.M. Ernst, Sudarshan A. Shetty, Leo Lahti.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

